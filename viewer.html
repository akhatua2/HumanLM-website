<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HumanLM | Data Viewer</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&family=Roboto:wght@400;500;700&family=Georgia&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --text: #1a1a1a;
            --text-secondary: #666;
            --accent: #e07a5f;
            --bg: #fff;
            --border: #e0e0e0;
        }

        body {
            font-family: 'IBM Plex Sans', -apple-system, sans-serif;
            background: #fff;
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* =============== NAVBAR =============== */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            padding: 1.25rem 0;
            background: #fff;
            z-index: 1000;
        }
        
        nav .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        nav .logo {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text);
            text-decoration: none;
            letter-spacing: -0.02em;
        }
        
        nav .links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        nav .links a {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        nav .links a:hover {
            color: var(--text);
            background: transparent !important;
        }

        nav .links a.active {
            color: var(--text);
            font-weight: 500;
        }

        /* =============== PAGE LAYOUT =============== */
        .page-wrapper {
            padding-top: 60px;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* =============== HEADER =============== */
        .page-header {
            padding: 48px 0 32px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        /* =============== TABS =============== */
        .tabs-container {
            position: sticky;
            top: 56px;
            background: #fff;
            margin-bottom: 24px;
            overflow-x: auto;
            z-index: 100;
            padding: 12px 0;
        }

        .tabs {
            display: flex;
            gap: 8px;
            max-width: 960px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .tab {
            flex: 1;
            padding: 10px 0;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text);
            background: none;
            border: 1.5px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .tab:hover {
            border-color: var(--text);
            background: #fff;
            transform: translateY(-1px);
        }

        .tab.active {
            color: white;
            background: var(--accent);
            border-color: var(--accent);
        }
        
        .tab.active:hover {
            background: var(--accent);
            border-color: var(--accent);
            opacity: 0.9;
        }

        /* =============== DATASET INFO =============== */
        .dataset-info {
            max-width: 960px;
            margin: 0 auto;
            padding: 1.5rem 2rem 1rem;
        }

        .dataset-info .description {
            font-size: 0.95rem;
            line-height: 1.7;
            color: var(--text);
            margin-bottom: 1.25rem;
        }

        .dataset-info .source {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .dataset-stats {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .dataset-stat {
            display: flex;
            flex-direction: column;
        }

        .dataset-stat .stat-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
        }

        .dataset-stat .stat-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        /* =============== CONTENT AREA =============== */
        .content-area {
            padding-bottom: 2rem;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .loading-spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* =============== SHARED COMPONENT STYLES =============== */
        .example-divider {
            margin: 48px 0;
            text-align: center;
            position: relative;
        }

        .example-divider::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 1px;
            background: var(--border);
        }

        .example-divider span {
            background: var(--bg);
            padding: 0 16px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: relative;
        }

        .persona-box {
            background: #FFFBEB;
            border: 1px solid #FDE68A;
            padding: 14px;
            margin-bottom: 14px;
            font-size: 13px;
            line-height: 1.6;
        }

        .ground-truth {
            background: #ECFDF5;
            border-left: 3px solid #10B981;
            padding: 14px;
            margin-top: 14px;
        }

        .ground-truth-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #10B981;
            margin-bottom: 10px;
        }

        .expandable {
            max-height: 120px;
            overflow: hidden;
            position: relative;
        }

        .expandable:not(.expanded)::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, var(--bg));
            pointer-events: none;
        }

        .expandable.expanded {
            max-height: none;
        }

        .expand-btn {
            background: none;
            border: none;
            color: var(--accent);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            padding: 4px 0;
        }

        .expand-btn:hover {
            text-decoration: underline;
        }

        /* =============== FOOTER =============== */
        footer {
            padding: 2rem 0;
            margin-top: 2rem;
            background: #fff !important;
        }
        
        footer .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        footer .affiliation {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        footer .affiliation .logo {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        footer .affiliation .logo img {
            height: 14px;
            width: auto;
            vertical-align: middle;
        }
        
        footer .affiliation .separator {
            margin: 0 0.5rem;
        }
        
        footer .links {
            display: flex;
            gap: 1.5rem;
        }
        
        footer .links a {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-decoration: none;
        }
        
        footer .links a:hover {
            color: var(--text);
            background: transparent !important;
        }

        .bibtex-copy {
            position: relative;
            cursor: pointer;
        }

        .bibtex-copy .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(4px);
            background: var(--text);
            color: var(--bg);
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s, transform 0.2s;
        }

        .bibtex-copy .tooltip.show {
            opacity: 1;
            transform: translateX(-50%) translateY(-4px);
        }

        /* =============== RESPONSIVE =============== */
        @media (max-width: 768px) {
            .dataset-info {
                padding: 1rem 2rem;
            }
            .dataset-stats {
                gap: 1.25rem;
            }
            .navbar-links {
                gap: 16px;
            }
            .page-title {
                font-size: 1.5rem;
            }
            .tab {
            padding: 10px 14px;
            font-size: 12px;
        }
        }

        @media (max-width: 640px) {
            footer .container {
                flex-direction: column;
                gap: 1rem;
            text-align: center;
            }
            
            footer .affiliation {
            justify-content: center;
            }
        }
    </style>
</head>
<body>
    <nav>
    <div class="container">
            <a href="index.html" class="logo"><img src="logo.png" alt="" style="height: 1.8em; vertical-align: -0.4em; margin-right: 0.4rem;">HumanLM</a>
            <div class="links">
                <a href="viewer.html" class="active">Datasets</a>
                <a href="blog.html">Blog</a>
                <a href="team.html">Team</a>
                <a href="HumanLM_paper.pdf" target="_blank">Paper <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -1px;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg></a>
                <a href="https://github.com/zou-group/humanlm" target="_blank" title="GitHub"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: -2px;"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg></a>
    </div>
        </div>
    </nav>

    <div class="page-wrapper">
    <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" data-tab="news">Humanual-News</button>
                <button class="tab" data-tab="book">Humanual-Book</button>
                <button class="tab" data-tab="opinion">Humanual-Opinion</button>
                <button class="tab" data-tab="politics">Humanual-Politics</button>
                <button class="tab" data-tab="chat">Humanual-Chat</button>
                <button class="tab" data-tab="email">Humanual-Email</button>
        </div>
    </div>

        <div class="dataset-info" id="dataset-info"></div>

        <div class="container">
            <div class="content-area" id="content-area">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p style="margin-top: 12px;">Loading...</p>
                </div>
            </div>
        </div>

    <footer>
        <div class="container">
            <div class="affiliation">
                <span class="logo">Stanford University<img src="logos/stanford.png" alt="Stanford"></span>
                <span class="separator">·</span>
                <span class="logo">New York University<img src="logos/nyu.png" alt="NYU"></span>
                <span class="separator">·</span>
                <span class="logo">Accenture<img src="logos/accenture.png" alt="Accenture"></span>
                    </div>
            <div class="links">
                <a href="#">arXiv</a>
                <a href="https://github.com/zou-group/humanlm" target="_blank">GitHub</a>
                <a href="javascript:void(0)" class="bibtex-copy" onclick="copyBibtex(this)">BibTeX<span class="tooltip">Copied!</span></a>
                </div>
                                </div>
    </footer>

    <script src="bibtex.js"></script>
    <script>
        // Dataset descriptions
        const datasetInfo = {
            news: {
                description: 'Humanual-News contains comments from YouTube users on videos posted by BBC and CNN news channels. The dataset highlights users\' different reactions and opinions regarding news events, using video transcriptions as input contexts.',
                source: 'YouTube Data API v3 · YouTube Transcript API',
                stats: { Users: '10,900', Posts: '6,117', Comments: '43,273', 'Avg Turns': '1.36' }
            },
            book: {
                description: 'Humanual-Book contains Amazon book reviews from frequent customers, each with around 192 reviews on average. The reviews express satisfaction or dissatisfaction with book content, reflecting users\' preferences and tastes.',
                source: 'Amazon Reviews 2023',
                stats: { Users: '209', Posts: '34,886', Comments: '40,136', 'Avg Reviews/User': '192' }
            },
            opinion: {
                description: 'Humanual-Opinion contains Reddit users expressing opinions across diverse personal-issue threads (r/AITA). These responses reflect users\' moral standards on controversial topics, e.g., family conflicts and life decisions.',
                source: 'Reddit r/AITA via asyncpraw',
                stats: { Users: '4,567', Threads: '992', Comments: '45,716', 'Avg Turns': '3.55' }
            },
            politics: {
                description: 'Humanual-Politics consists of Medium users and their responses to blog posts on political topics. It features diverse political stances from real users spanning different cultural backgrounds, intended to simulate user responses to long-form written content.',
                source: 'RapidAPI Medium endpoint',
                stats: { Users: '5,303', Posts: '14,557', Comments: '50,273', 'Avg Turns': '1.76' }
            },
            chat: {
                description: 'Humanual-Chat consists of conversations between users and LLM assistants of 5\u201310 turns, adapted from WildChat. The goal is to simulate interactive user behaviors with LLM assistants, including follow-ups, goal changes, and clarification turns.',
                source: 'WildChat',
                stats: { Users: '4,801', Conversations: '4,826', Messages: '29,334', 'Avg Turns': '7.56' }
            },
            email: {
                description: 'Humanual-Email is adapted from the Enron email dataset. It captures user communication in business settings, including decision negotiation, project status reporting, and constraint resolution.',
                source: 'Enron corpus',
                stats: { Users: '399', Threads: '5,153', Messages: '7,577', 'Avg Turns': '1.68' }
            }
        };

        function renderDatasetInfo(tabName) {
            const info = datasetInfo[tabName];
            if (!info) return;
            const statsHtml = Object.entries(info.stats).map(([label, value]) =>
                `<div class="dataset-stat"><span class="stat-value">${value}</span><span class="stat-label">${label}</span></div>`
            ).join('');
            document.getElementById('dataset-info').innerHTML = `
                <p class="description">${info.description}</p>
                <div class="source">${info.source}</div>
                <div class="dataset-stats">${statsHtml}</div>
            `;
        }

        // Tab state
        let currentTab = 'news';
        const contentCache = {};
        
        // Carousel state
        let currentExampleIndex = 0;
        let totalExamples = 0;

        // Get initial tab from URL hash
        function getInitialTab() {
            const hash = window.location.hash.substring(1); // Remove the #
            const validTabs = ['news', 'book', 'opinion', 'politics', 'chat', 'email'];
            if (hash && validTabs.includes(hash)) {
                return hash;
            }
            return 'news'; // Default to news
        }

        // Update URL hash when tab changes
        function updateURLHash(tabName) {
            window.location.hash = tabName;
        }

        // Load component HTML
        async function loadComponent(name) {
            const contentArea = document.getElementById('content-area');
            
            // Show loading
            contentArea.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p style="margin-top: 12px;">Loading...</p>
                                </div>
            `;

            // Check cache first
            if (contentCache[name]) {
                contentArea.innerHTML = contentCache[name];
                initExpandButtons();
                initCarousel();
                return;
            }

            try {
                const response = await fetch(`components/${name}.html`);
                if (!response.ok) throw new Error('Component not found');
                const html = await response.text();
                contentCache[name] = html;
                contentArea.innerHTML = html;
                initExpandButtons();
                initCarousel();
            } catch (error) {
                contentArea.innerHTML = `
                    <div class="loading">
                        <p>Failed to load component. Please try again.</p>
                    </div>
                `;
            }
        }
        
        // Initialize carousel navigation
        function initCarousel() {
            const slides = document.querySelectorAll('.example-slide');
            if (slides.length === 0) return;
            
            totalExamples = slides.length;
            currentExampleIndex = 0;
            
            // Ensure first slide is active
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === 0);
            });
            
            // Attach button listeners
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (prevBtn) {
                prevBtn.onclick = () => changeExample(-1);
            }
            if (nextBtn) {
                nextBtn.onclick = () => changeExample(1);
            }
        }
        
        // Change example slide
        function changeExample(direction) {
            const slides = document.querySelectorAll('.example-slide');
            if (slides.length === 0) return;
            
            slides[currentExampleIndex].classList.remove('active');
            
            currentExampleIndex += direction;
            if (currentExampleIndex < 0) currentExampleIndex = totalExamples - 1;
            if (currentExampleIndex >= totalExamples) currentExampleIndex = 0;
            
            slides[currentExampleIndex].classList.add('active');
        }
        
        // Make changeExample global
        window.changeExample = changeExample;

        // Initialize expand/collapse buttons
        function initExpandButtons() {
            // Re-attach event listeners for expand buttons
            document.querySelectorAll('.expand-btn').forEach(btn => {
                btn.onclick = function() {
                    const targetId = this.previousElementSibling?.id || 
                                     this.closest('.persona-box')?.querySelector('.expandable')?.id ||
                                     this.closest('.email-body-text')?.querySelector('.expandable')?.id;
                    if (targetId) {
                        toggleExpand(targetId, this);
                    }
                };
            });
        }

        // Toggle expand/collapse
        function toggleExpand(id, btn) {
            const element = document.getElementById(id);
            if (!element) return;
            
            element.classList.toggle('expanded');
            if (btn) {
                btn.textContent = element.classList.contains('expanded') ? 'Show less' : 'Show more';
            }
        }

        // Make toggleExpand global for inline onclick handlers
        window.toggleExpand = toggleExpand;

        // Switch to a specific tab
        function switchToTab(tabName) {
            currentTab = tabName;
            
            // Update active state
            document.querySelectorAll('.tab').forEach(tab => {
                if (tab.dataset.tab === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // Update URL hash
            updateURLHash(tabName);

            // Update dataset info
            renderDatasetInfo(tabName);

            // Load component
            loadComponent(tabName);
        }

        // Tab click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.dataset.tab;
                switchToTab(tabName);
                });
            });

        // Handle hash changes (back/forward buttons, manual URL changes)
        window.addEventListener('hashchange', () => {
            const tabFromHash = getInitialTab();
            if (tabFromHash !== currentTab) {
                switchToTab(tabFromHash);
            }
        });

        // Initialize tab from URL hash on page load
        // Use DOMContentLoaded to ensure DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                const initialTab = getInitialTab();
                switchToTab(initialTab);
            });
            } else {
            // DOM already loaded
            const initialTab = getInitialTab();
            switchToTab(initialTab);
        }
    </script>
</body>
</html>
